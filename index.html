<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="main.css">
    <title>GreenCity</title>
</head>
<body>
    <header>
        <img src="./assets/06-LOGO.png">
    </header>

<div id="mySidenav" class="sidenav">
    <a class="closebtn" onclick="closeNav()">&times;</a>
</div>

    <h1>Vem tomar um café<br>com a gente</h1>
    <button class="nav" onclick="openNav()"><h2>Pedidos</h2></button>

    <!-- Recomendamos que você não altere os IDs dos elementos do formulário -->
    <div class="content">
        <form id="contact" method="post" action="#" name="userForm" >
            <input type="text" name='username' id="name" placeholder="Nome">
            <input type="text"  name="email" id="email" placeholder="Endereço de email">
            <textarea name="message" id="message" cols="22" rows="10" placeholder="Mensagem"></textarea>
            <input type="submit" class="button" value="Enviar">
        </form>
    </div>

    <script src="./main.js"></script>
</body>

<script>
document.userForm.onsubmit = async e => {
    e.preventDefault()
    const form = e.target
    const data = new FormData(form)
    const options = {
        method: form.method,
        body: new URLSearchParams(data)
        }
    fetch('/validation', options)
        .then(resp => resp.json())
        .then(res => {
            if (res == true){
                window.alert("Dados enviados com sucesso, acesse a barra lateral, para acompanhar seu pedido")
                addElement()
            }
            else{
                var text = "";
                res.forEach(e=>{
                    e = "," + e;
                    text += e;
                })
                window.alert(`Mistakes${text}`)
            }
        })         
}

function openNav() {
    document.getElementById("mySidenav").style.width = "250px";
}

function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
}
function addElement(){
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const messageInput = document.getElementById('message');

    const nameValue = nameInput.value;
    const messageValue = messageInput.value;

    const side = document.getElementById('mySidenav')
    const ul = document.createElement("ul");
    const li = document.createElement("li");
    //const li2 = document.createElement("li");
    ul.innerHTML = `<span style="font-weight: bold; color: #fff; font-size:30px;" >${nameValue}</span>`
    li.innerHTML = `<span style="color: black; font-size: 20px;" >${messageValue}</span>`
    ul.append(li)
    side.append(ul)
}
</script>

</html>
